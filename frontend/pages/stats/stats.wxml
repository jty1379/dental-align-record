<!--pages/stats/stats.wxml-->
<view class="container">
  <!-- å‘¨é€‰æ‹©å™¨ -->
  <view class="week-selector">
    <view class="week-btn" bindtap="onPrevWeek">
      <text class="arrow">â€¹</text>
    </view>
    <text class="week-label">{{weekLabel}}</text>
    <view class="week-btn {{weekOffset >= 0 ? 'disabled' : ''}}" bindtap="onNextWeek">
      <text class="arrow">â€º</text>
    </view>
  </view>
  
  <!-- å›¾è¡¨åŒºåŸŸ -->
  <view class="chart-card">
    <view class="chart-title">ä½©æˆ´æ—¶é•¿ç»Ÿè®¡</view>
    <view class="chart-container">
      <!-- ç®€æ˜“æŸ±çŠ¶å›¾ -->
      <view class="bars-wrapper">
        <view class="bar-item" wx:for="{{weekData}}" wx:key="date">
          <view class="bar-wrapper">
            <view 
              class="bar {{item.completed ? 'completed' : ''}}" 
              style="height: {{item.hours / targetHours * 100}}%"
            ></view>
          </view>
          <text class="bar-label">{{item.dayLabel}}</text>
          <text class="bar-value">{{item.hours}}h</text>
        </view>
      </view>
      <!-- ç›®æ ‡çº¿ -->
      <view class="target-line">
        <text class="target-text">ç›®æ ‡ {{targetHours}}h</text>
      </view>
    </view>
  </view>
  
  <!-- ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-row">
    <view class="stat-card">
      <text class="stat-value">{{avgHours}}</text>
      <text class="stat-unit">å°æ—¶</text>
      <text class="stat-label">æ—¥å‡ä½©æˆ´</text>
    </view>
    <view class="stat-card">
      <text class="stat-value">{{completionRate}}</text>
      <text class="stat-unit">%</text>
      <text class="stat-label">æœ¬å‘¨å®Œæˆç‡</text>
    </view>
    <view class="stat-card highlight">
      <text class="stat-value">{{currentStreak}}</text>
      <text class="stat-unit">å¤©</text>
      <text class="stat-label">è¿ç»­è¾¾æ ‡</text>
    </view>
  </view>
  
  <!-- æˆå°±å¡ç‰‡ -->
  <view class="achievement-card">
    <view class="achievement-header">
      <text class="achievement-title">ğŸ† æˆå°±</text>
    </view>
    <view class="achievement-row">
      <view class="achievement-item">
        <text class="ach-value">{{longestStreak}}</text>
        <text class="ach-label">æœ€é•¿è¿ç»­å¤©æ•°</text>
      </view>
      <view class="achievement-item">
        <text class="ach-value">{{totalCompletedDays}}</text>
        <text class="ach-label">æ€»è¾¾æ ‡å¤©æ•°</text>
      </view>
    </view>
  </view>
  
  <!-- å»ºè®®å¡ç‰‡ -->
  <view class="suggestion-card" wx:if="{{suggestions.length > 0}}">
    <view class="suggestion-header">
      <text class="suggestion-icon">ğŸ’¡</text>
      <text class="suggestion-title">æ™ºèƒ½å»ºè®®</text>
    </view>
    <view class="suggestion-list">
      <view class="suggestion-item" wx:for="{{suggestions}}" wx:key="index">
        <text>{{item}}</text>
      </view>
    </view>
  </view>
  
  <!-- åˆ†äº«æŒ‰é’® -->
  <button class="share-btn" bindtap="onShareReport">
    <text class="share-icon">ğŸ“¤</text>
    <text>åˆ†äº«å‘¨æŠ¥åˆ°æœ‹å‹åœˆ</text>
  </button>
</view>
